{"ast":null,"code":"var _jsxFileName = \"/home/terry/taps/src/components/StableMarriage.js\";\nimport React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport { shuffleArray, removeItemOnce, randomOneOrMinusOne, XOR, shuffleSegment } from \"./utils/PythonFunctions\";\nimport { getMeanTAHours, createCourseHierarchy, createCourseHierarchyForTA, createTAHierarchy, sortTAsByHours } from \"./utils/PreprocessingFunctions\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { saveAs } from 'file-saver';\nimport './AllClassesCSV.css';\n\n// Handles the displays for each of the layout options\nimport ColbyCol from \"./layoutHandlers/ColbyCol\";\nimport SidebySide from \"./layoutHandlers/SidebySide\";\nimport OnlySchedLayout from \"./layoutHandlers/OnlySchedLayout\";\nimport { OnlyConflictsLayout } from \"./layoutHandlers/OnlyConflictsLayout\";\n// Routing in order to switch user from one page to another (one layout to another). \nimport { BrowserRouter as Router, Routes, Route, Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction StableMarriage(props) {\n  const ITERATIONS = 10000; // 20000\n  const AUDIBLE_COUNT = 300;\n\n  // Contains a list of all matches made by algorithm //\n  let total_matches = [];\n\n  // Schedule // \n  let schedule = {};\n  var history = [];\n  console.log(props);\n  const {\n    courses,\n    tas,\n    predeterminations\n  } = props;\n  const setProgress = props.setProgress;\n\n  // Courses // \n  var preferred_rankings_men = {};\n\n  // Course Hours //\n  let remaining_hours_men = {};\n\n  // TAs //\n  var preferred_rankings_women = {};\n\n  // TA hours //\n  let remaining_hours_women = {};\n\n  // Keeps track of tentative Matches //\n  let tentative_engagements = [];\n\n  // Courses waiting for TA assignment //\n  let free_men = [];\n\n  //  Runs Algorithm  //\n  function stable_matching() {\n    while (free_men.length > 0) {\n      free_men.forEach(man => begin_matching(man));\n    }\n  }\n  function createCourseTas(c, t) {\n    createCourseHierarchy(c);\n    sortTAsByHours(t);\n    // console.log(c)\n    let courses = c.map(item => item.CRN);\n    let tas = t.map(item => item.uuid);\n    let preferred_rankings_men = {};\n    let preferred_rankings_women = {};\n    let remaining_hours_men = {};\n    let remaining_hours_women = {};\n    courses.forEach(course => {\n      const num_elig_tas = c.find(item => item.CRN === course).teacher_assistants.length;\n      // preferred_rankings_men[course] = createTAHierarchy(c, course, tas, t)\n      preferred_rankings_men[course] = shuffleSegment(shuffleSegment(createTAHierarchy(c, course, tas, t), 0, num_elig_tas - 1), num_elig_tas);\n      // console.log(course + \" Hours: \" + c.find(item => item.CRN === course).taHours + \", \" + preferred_rankings_men[course].map(item => t.find(i => i.uuid === item).taHours))\n      remaining_hours_men[course] = Number(c.find(item => item.CRN === course).taHours);\n    });\n    tas.forEach(ta => {\n      preferred_rankings_women[ta] = createCourseHierarchyForTA(ta, c, courses);\n      remaining_hours_women[ta] = Number(t.find(item => item.uuid === ta).taHours);\n    });\n    return [preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women];\n  }\n\n  // Resets Available Courses (yet to be matched tentatively or otherwise) //\n  function init_free_men() {\n    for (const course in preferred_rankings_men) {\n      if (remaining_hours_men[course] > 0) free_men.push(course);\n    }\n  }\n\n  // Stable Matching Algorithm // \n  function begin_matching(man) {\n    preferred_rankings_men[man].every(woman => {\n      // Boolean for whether ta is taken or not //\n      var taken_match = [];\n      tentative_engagements.forEach(couple => {\n        if (couple.includes(woman)) taken_match.push(couple);\n      });\n      if (taken_match.length === 0) {\n        tentative_engagements.push([man, woman]);\n        free_men = removeItemOnce(free_men, man);\n        return false;\n      } else if (taken_match.length > 0) {\n        const current_course = preferred_rankings_women[woman].indexOf(taken_match[0][0]);\n        const potential_course = preferred_rankings_women[woman].indexOf(man);\n        if (current_course >= potential_course) {\n          free_men = removeItemOnce(free_men, man);\n          free_men.push(taken_match[0][0]);\n          taken_match[0][0] = man;\n          return false;\n        }\n      }\n      return true;\n    });\n  }\n\n  //  Removes assigned hours from remaining hours  //\n  function allot_hours(matches, predet) {\n    const mean = getMeanTAHours(remaining_hours_women);\n    // console.log(\"Mean: \" + mean + \" -----------\")\n\n    matches.forEach(course_ta => {\n      var course, ta, course_hours, ta_hours;\n      if (!predet) {\n        var course = course_ta[0];\n        var ta = course_ta[1];\n        var course_hours = Number(remaining_hours_men[course]);\n        var ta_hours = Number(remaining_hours_women[ta]);\n      } else {\n        var course = course_ta[0][0];\n        var ta = course_ta[0][1];\n        var course_hours = Number(remaining_hours_men[course]);\n        var ta_hours = Math.min(course_ta[1], Number(remaining_hours_women[ta]));\n      }\n      // console.log(course + \" -\" + course_hours + \"- \" + ta + \"_\" + ta_hours)\n      if (Number(ta_hours) < Number(course_hours) && !predet) {\n        // console.log(\"\\t\" + course + \":: \"+ ta+ \"_\" + ta_hours + \": \" + course_hours + \" ||| Mean-10: \" + (mean-10))\n        if (ta_hours < mean - 10) {\n          // console.log(\"\\t\"+ ta_hours + \" : Mean:\" + mean)\n          ta_hours = 0;\n        }\n      }\n      var hours_alloted = Math.min(course_hours, ta_hours);\n      // console.log(\"\\t HA: \" + hours_alloted)\n      remaining_hours_men[course] -= hours_alloted;\n      remaining_hours_women[ta] -= hours_alloted;\n      if (hours_alloted != 0) total_matches.push([[course, ta], hours_alloted]);\n    });\n  }\n\n  //  Removes TAs and Courses if they are out of hours  //\n  function remove_tas() {\n    free_men.forEach(course => {\n      var temp_array = [...preferred_rankings_men[course]];\n      preferred_rankings_men[course].forEach(ta => {\n        if (remaining_hours_women[ta] === 0) temp_array = removeItemOnce(temp_array, ta);\n      });\n      preferred_rankings_men[course] = temp_array;\n    });\n    preferred_rankings_men[free_men[0]].forEach(ta => {\n      var temp_array = [...preferred_rankings_women[ta]];\n      preferred_rankings_women[ta].forEach(course => {\n        if (!free_men.includes(course)) temp_array = removeItemOnce(temp_array, course);\n      });\n      preferred_rankings_women[ta] = temp_array;\n    });\n  }\n\n  //  Adds dummie Tas or Courses to account for the restrictionn of the algorthim of tas and courses having to be the same length  //\n  function add_dummies() {\n    if (free_men.length < preferred_rankings_men[free_men[0]].length) {\n      const difference = preferred_rankings_men[free_men[0]].length - free_men.length;\n      for (let i of Array(difference).keys()) {\n        const dummy = 'dummy' + i;\n        preferred_rankings_men[dummy] = [...preferred_rankings_men[free_men[i]]].reverse();\n        remaining_hours_men[dummy] = 0;\n        free_men.push(dummy);\n        // for(let i = 0; i < preferred_rankings_men[free_men[0]].length; i++)\n        // \tpreferred_rankings_women[preferred_rankings_men[free_men[0]][i]].push(dummy)\n        preferred_rankings_men[free_men[0]].forEach(ta => preferred_rankings_women[ta].push(dummy));\n      }\n    } else if (free_men.length > preferred_rankings_men[free_men[0]].length && preferred_rankings_men[free_men[0]].length > 0) {\n      const difference = free_men.length - preferred_rankings_men[free_men[0]].length;\n      for (let i of Array(difference).keys()) {\n        const dummy = 'dummy' + i;\n        preferred_rankings_women[dummy] = [...preferred_rankings_women[preferred_rankings_men[free_men[0]][i]]].reverse();\n        remaining_hours_women[dummy] = 0;\n        // for (let i=0; i < free_men.length; i++){\n        // \tpreferred_rankings_men[free_men[0]].push(dummy)\n        // }\n        free_men.forEach(course => preferred_rankings_men[course].push(dummy));\n      }\n    }\n  }\n\n  //  Checks to see if all TAs or All Courses are out of hours  //\n  function check_done() {\n    var ta_check = true;\n    var course_check = true;\n    for (const ta in preferred_rankings_women) {\n      if (remaining_hours_women[ta] > 0) ta_check = false;\n    }\n    for (const course in preferred_rankings_men) {\n      if (remaining_hours_men[course] > 0) course_check = false;\n    }\n    return ta_check || course_check;\n  }\n\n  //  Prints Schedule  //\n  function make_schedule() {\n    var sched = {};\n    total_matches.forEach(m => {\n      // m is [[course, ta], hours_alloted]\n      if (!(m[0][0] in sched)) sched[m[0][0]] = [];\n      if (!m[0][0].includes('dummy') && !m[0][1].includes('dummy')) sched[m[0][0]].push([m[0][1], m[1]]);\n    });\n    for (var course in sched) {\n      // schedule[course].forEach(x => setTentSchedule(a += '[' + x + ']'))\n      //   FILLS Dictionary for Table   // \n      while (sched[course].length < 2) {\n        sched[course].push(['', '']);\n      }\n    }\n    return sched;\n  }\n\n  //  Runs entire algorithm  //\n  function run_all() {\n    let comp = 100;\n    let compl = [];\n    let count = 0;\n    let current_matches = [];\n    let remaining_hours = {};\n    for (var i = 0; i < ITERATIONS; i++) {\n      [preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women] = createCourseTas(courses, tas);\n      free_men = [];\n      total_matches = [];\n      init_free_men();\n      tentative_engagements = [...new Set([...predeterminations, ...current_matches])];\n      allot_hours(tentative_engagements, true);\n      tentative_engagements = [];\n      add_dummies();\n      while (!check_done() && free_men.length > 0) {\n        stable_matching();\n        allot_hours(tentative_engagements, false);\n        tentative_engagements = [];\n        init_free_men();\n        if (free_men.length > 0 && preferred_rankings_men[free_men[0]].length > 0) {\n          remove_tas();\n          add_dummies();\n        }\n      }\n\n      // Why is make_schedule called twice?\n      const [complications, working_matches] = validate_schedule(make_schedule(), courses);\n      if (complications.length < comp) {\n        schedule = make_schedule();\n        compl = complications;\n        comp = compl.length;\n        current_matches = working_matches;\n        count = 0;\n        remaining_hours = {\n          ...remaining_hours_men\n        };\n      } else if (count >= AUDIBLE_COUNT) {\n        history.push([schedule, compl, comp, remaining_hours]);\n        comp = 100;\n        current_matches = [];\n        remaining_hours = {};\n        count = 0;\n      }\n      console.log(compl.length);\n      count += 1;\n    }\n    history.sort((a, b) => a[2] - b[2]);\n    schedule = history[0][0];\n    console.log(history);\n    console.log(schedule);\n  }\n  function validate_schedule(schedule, courses) {\n    var complications = [];\n    var working_matches = [];\n    for (let course in schedule) {\n      const l = schedule[course].length;\n      if (l >= 3) complications.push([course, \"\", \"\", \"\", \"This course has \" + l + \" TAs\"]);\n      for (var i = 0; i < l; i++) {\n        if (schedule[course][i][0] === '') continue;\n        const current_course = courses.find(c => c.CRN === course);\n        let course_ta = current_course.teacher_assistants.find(item => item.TAID === schedule[course][i][0]);\n        if (course_ta.able == false) {\n          let curTA_uuid = schedule[course][i][0];\n          let curTA = tas.find(t => t.uuid === curTA_uuid);\n          let reasons = course_ta.reason;\n          // Changed complications from having only one index to having multiple indices for easibility in retrieving information\n          complications.push([course, curTA_uuid, curTA.firstName, curTA.lastName, reasons]);\n        } else {\n          working_matches.push([[course, schedule[course][i][0]], schedule[course][i][1]]);\n        }\n      }\n    }\n    return [complications, working_matches];\n  }\n\n  // Adding course name \n  function course_name(course) {\n    const current_course = courses.find(c => c.CRN === course);\n    const course_name = 'COMP ' + current_course.course_number;\n    return course_name;\n  }\n\n  // Combining the course's name , section , and crn\n  function course_combo(course) {\n    const current_course = courses.find(c => c.CRN === course);\n    const course_name = current_course.course_number;\n    return current_course.course_number + current_course.Section + course;\n  }\n  [preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women] = createCourseTas(courses, tas);\n  run_all();\n  function convertToCSV(schedule, remaining_hours_men, conflictReport) {\n    const rows = [];\n    let headers = \"Course,Remaining Hours,TA 1,TA 1 Hours,TA 2,TA 2 Hours,TA 3, TA 3 Hours,,Eligible TAs\";\n    console.log(schedule);\n    console.log(courses[0].teacher_assistants);\n    Object.keys(schedule).forEach(course => {\n      if (schedule[course].length >= 3) {\n        rows.push([course, remaining_hours_men[course], schedule[course][0][0], schedule[course][0][1], schedule[course][1][0], schedule[course][1][1], schedule[course][2][0], schedule[course][2][1], '|'].concat(courses.find(c => c.CRN === course).teacher_assistants.map(t => t.able_map).sort()));\n      } else {\n        rows.push([course_combo(course), remaining_hours_men[course], schedule[course][0][0], schedule[course][0][1], schedule[course][1][0], schedule[course][1][1], '', '', '|'].concat(courses.find(c => c.CRN === course).teacher_assistants.map(t => t.able_map).sort()));\n      }\n    });\n    rows.push([]);\n    rows.push([\"Conflict's Course Name\", \"Conflict's CRN\", \"UID\", \"Last Name\", \"First Name\", \"Conflict Reason\"]);\n    conflictReport.forEach(conflict => {\n      rows.push([course_name(conflict[0]), conflict[0], conflict[1], conflict[2], conflict[3], conflict[4]]);\n    });\n\n    //const csv = headers + '\\n' + Object.entries(obj).map(([key, value]) => Object.values(value).join(',')).join('\\n');\n    const csv = headers + '\\n' + rows.map(row => row.join(',')).join('\\n');\n    return csv;\n  }\n  function downloadCSV(csvData, fileName) {\n    const blob = new Blob([csvData], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    saveAs(blob, fileName);\n  }\n  function handleDownload(event) {\n    const csv = convertToCSV(history[event.target.value][0], history[event.target.value][3], history[event.target.value][1]);\n    downloadCSV(csv, 'schedule' + event.target.value + '.csv');\n  }\n  console.log(history);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"w3-sidebar w3-bar-block w3-border\",\n        style: {\n          width: \"10%\",\n          height: \"auto\",\n          position: \"relative\",\n          float: \"left\",\n          left: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          children: \"Column View\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/side_view\",\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          children: \"Side View\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/schedules\",\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          children: \"Schedules\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/conflicts\",\n          class: \"w3-bar-item w3-button w3-border-bottom \",\n          children: \"Conflicts\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          value: 0,\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          style: {\n            alignContent: \"left\"\n          },\n          onClick: handleDownload,\n          children: \"Download Report 1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          value: 1,\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          style: {\n            alignContent: \"left\"\n          },\n          onClick: handleDownload,\n          children: \"Download Report 2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          value: 2,\n          class: \"w3-bar-item w3-button w3-border-bottom\",\n          style: {\n            alignContent: \"left\"\n          },\n          onClick: handleDownload,\n          children: \"Download Report 3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 4\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"container\",\n        style: {\n          left: 0\n        },\n        children: /*#__PURE__*/_jsxDEV(Routes, {\n          children: [console.log(tas), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/\",\n            element: /*#__PURE__*/_jsxDEV(ColbyCol, {\n              taList: tas,\n              coursesList: courses,\n              reportOne: history[0],\n              reportTwo: history[1],\n              reportThree: history[2]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 32\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/side_view\",\n            element: /*#__PURE__*/_jsxDEV(SidebySide, {\n              taList: tas,\n              coursesList: courses,\n              reportOne: history[0],\n              reportTwo: history[1],\n              reportThree: history[2]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/schedules\",\n            element: /*#__PURE__*/_jsxDEV(OnlySchedLayout, {\n              taList: tas,\n              coursesList: courses,\n              scheduleOne: history[0][0],\n              scheduleTwo: history[1][0],\n              scheduleThree: history[2][0]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/conflicts\",\n            element: /*#__PURE__*/_jsxDEV(OnlyConflictsLayout, {\n              taList: tas,\n              coursesList: courses,\n              conflictsOne: history[0][1],\n              conflictsTwo: history[1][1],\n              conflictsThree: history[2][1]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 6\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 4\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 3\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 412,\n    columnNumber: 2\n  }, this);\n}\n_c = StableMarriage;\nexport default StableMarriage;\nvar _c;\n$RefreshReg$(_c, \"StableMarriage\");","map":{"version":3,"names":["React","useState","useEffect","shuffleArray","removeItemOnce","randomOneOrMinusOne","XOR","shuffleSegment","getMeanTAHours","createCourseHierarchy","createCourseHierarchyForTA","createTAHierarchy","sortTAsByHours","saveAs","ColbyCol","SidebySide","OnlySchedLayout","OnlyConflictsLayout","BrowserRouter","Router","Routes","Route","Link","jsxDEV","_jsxDEV","StableMarriage","props","ITERATIONS","AUDIBLE_COUNT","total_matches","schedule","history","console","log","courses","tas","predeterminations","setProgress","preferred_rankings_men","remaining_hours_men","preferred_rankings_women","remaining_hours_women","tentative_engagements","free_men","stable_matching","length","forEach","man","begin_matching","createCourseTas","c","t","map","item","CRN","uuid","course","num_elig_tas","find","teacher_assistants","Number","taHours","ta","init_free_men","push","every","woman","taken_match","couple","includes","current_course","indexOf","potential_course","allot_hours","matches","predet","mean","course_ta","course_hours","ta_hours","Math","min","hours_alloted","remove_tas","temp_array","add_dummies","difference","i","Array","keys","dummy","reverse","check_done","ta_check","course_check","make_schedule","sched","m","run_all","comp","compl","count","current_matches","remaining_hours","Set","complications","working_matches","validate_schedule","sort","a","b","l","TAID","able","curTA_uuid","curTA","reasons","reason","firstName","lastName","course_name","course_number","course_combo","Section","convertToCSV","conflictReport","rows","headers","Object","concat","able_map","conflict","csv","row","join","downloadCSV","csvData","fileName","blob","Blob","type","handleDownload","event","target","value","children","class","style","width","height","position","float","left","to","_jsxFileName","lineNumber","columnNumber","alignContent","onClick","path","element","taList","coursesList","reportOne","reportTwo","reportThree","scheduleOne","scheduleTwo","scheduleThree","conflictsOne","conflictsTwo","conflictsThree","_c","$RefreshReg$"],"sources":["/home/terry/taps/src/components/StableMarriage.js"],"sourcesContent":["import React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { shuffleArray, removeItemOnce, randomOneOrMinusOne, XOR, shuffleSegment} from \"./utils/PythonFunctions\";\r\nimport { getMeanTAHours, createCourseHierarchy, createCourseHierarchyForTA, createTAHierarchy, sortTAsByHours } from \"./utils/PreprocessingFunctions\"\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport { saveAs } from 'file-saver';\r\nimport './AllClassesCSV.css';\r\n\r\n// Handles the displays for each of the layout options\r\nimport ColbyCol from \"./layoutHandlers/ColbyCol\";\r\nimport SidebySide from \"./layoutHandlers/SidebySide\";\r\nimport OnlySchedLayout from \"./layoutHandlers/OnlySchedLayout\";\r\nimport { OnlyConflictsLayout } from \"./layoutHandlers/OnlyConflictsLayout\";\r\n// Routing in order to switch user from one page to another (one layout to another). \r\nimport { BrowserRouter as Router, Routes, Route, Link } from \"react-router-dom\";\r\n\r\n\r\nfunction StableMarriage(props) {\r\n\r\nconst ITERATIONS = 10000 // 20000\r\nconst AUDIBLE_COUNT = 300\r\n\r\n// Contains a list of all matches made by algorithm //\r\nlet total_matches = []\r\n\r\n// Schedule // \r\nlet schedule = {}\r\n\r\nvar history = []\r\n\r\nconsole.log(props)\r\nconst {courses, tas, predeterminations} = props\r\nconst setProgress = props.setProgress\r\n\r\n// Courses // \r\nvar preferred_rankings_men = {}\r\n\r\n// Course Hours //\r\nlet remaining_hours_men = {}\r\n\r\n// TAs //\r\nvar preferred_rankings_women = {}\r\n\r\n// TA hours //\r\nlet remaining_hours_women = {}\r\n\r\n// Keeps track of tentative Matches //\r\nlet tentative_engagements = []\r\n\r\n// Courses waiting for TA assignment //\r\nlet free_men = []\r\n\r\n\r\n\r\n//  Runs Algorithm  //\r\nfunction stable_matching(){\r\n\twhile(free_men.length > 0){\r\n\t\tfree_men.forEach(man => begin_matching(man))\r\n\t}\r\n}\r\n\r\nfunction createCourseTas(c, t){\r\n\tcreateCourseHierarchy(c)\r\n\tsortTAsByHours(t)\r\n\t// console.log(c)\r\n\tlet courses = c.map(item => item.CRN);\r\n\tlet tas = t.map(item => item.uuid)\r\n\tlet preferred_rankings_men = {}\r\n\tlet preferred_rankings_women = {}\r\n\tlet remaining_hours_men = {}\r\n\tlet remaining_hours_women = {}\r\n\t\r\n\tcourses.forEach(course => {\r\n\t\tconst num_elig_tas = c.find(item => item.CRN === course).teacher_assistants.length\r\n\t\t// preferred_rankings_men[course] = createTAHierarchy(c, course, tas, t)\r\n\t\tpreferred_rankings_men[course] = shuffleSegment(shuffleSegment(createTAHierarchy(c, course, tas, t), 0, num_elig_tas-1), num_elig_tas)\r\n\t\t// console.log(course + \" Hours: \" + c.find(item => item.CRN === course).taHours + \", \" + preferred_rankings_men[course].map(item => t.find(i => i.uuid === item).taHours))\r\n\t\tremaining_hours_men[course] = Number(c.find(item => item.CRN === course).taHours)\r\n\t})\r\n\ttas.forEach(ta => {\r\n\t\tpreferred_rankings_women[ta] = createCourseHierarchyForTA(ta, c, courses)\r\n\t\tremaining_hours_women[ta] = Number(t.find(item => item.uuid === ta).taHours)\r\n\t}) \r\n\r\n\treturn [preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women]\r\n}\r\n\r\n\r\n// Resets Available Courses (yet to be matched tentatively or otherwise) //\r\nfunction init_free_men(){\r\n\tfor (const course in preferred_rankings_men) {\r\n\t\tif (remaining_hours_men[course] > 0)\r\n\t\t\tfree_men.push(course)\r\n\t}\r\n} \r\n\r\n// Stable Matching Algorithm // \r\nfunction begin_matching(man){\r\n\r\n\tpreferred_rankings_men[man].every(woman =>{\r\n\t\t// Boolean for whether ta is taken or not //\r\n\t\tvar taken_match = []\r\n\t\ttentative_engagements.forEach(couple => {\r\n\t\t\tif (couple.includes(woman))\r\n\t\t\t\ttaken_match.push(couple)\r\n\t\t})\r\n\t\t\r\n\t\tif (taken_match.length === 0){\r\n\t\t\ttentative_engagements.push([man, woman])\r\n\t\t\tfree_men = removeItemOnce(free_men, man)\r\n\t\t\treturn false;\r\n\t\t} else if (taken_match.length > 0){\r\n\t\t\tconst current_course = preferred_rankings_women[woman].indexOf(taken_match[0][0])\r\n\t\t\tconst potential_course = preferred_rankings_women[woman].indexOf(man)\r\n\r\n\t\t\tif (current_course >= potential_course){\r\n\t\t\t\tfree_men = removeItemOnce(free_men, man)\r\n\t\t\t\tfree_men.push(taken_match[0][0])\r\n\t\t\t\ttaken_match[0][0] = man\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t})\r\n}\r\n\r\n//  Removes assigned hours from remaining hours  //\r\nfunction allot_hours(matches, predet){\r\n\tconst mean = getMeanTAHours(remaining_hours_women)\r\n\t// console.log(\"Mean: \" + mean + \" -----------\")\r\n\r\n\tmatches.forEach(course_ta => {\r\n\t\tvar course, ta, course_hours, ta_hours\r\n\t\tif (!predet){\r\n\t\t\tvar course = course_ta[0]\r\n\t\t\tvar ta = course_ta[1]\r\n\t\t\tvar course_hours = Number(remaining_hours_men[course])\r\n\t\t\tvar ta_hours = Number(remaining_hours_women[ta])\r\n\t\t}else{\r\n\t\t\tvar course = course_ta[0][0]\r\n\t\t\tvar ta = course_ta[0][1]\r\n\t\t\tvar course_hours = Number(remaining_hours_men[course])\r\n\t\t\tvar ta_hours = Math.min(course_ta[1], Number(remaining_hours_women[ta]))\r\n\t\t}\r\n\t\t// console.log(course + \" -\" + course_hours + \"- \" + ta + \"_\" + ta_hours)\r\n\t\tif ((Number(ta_hours) < Number(course_hours)) && !predet){\r\n\t\t\t// console.log(\"\\t\" + course + \":: \"+ ta+ \"_\" + ta_hours + \": \" + course_hours + \" ||| Mean-10: \" + (mean-10))\r\n\t\t\tif (ta_hours < (mean-10)){\r\n\t\t\t\t// console.log(\"\\t\"+ ta_hours + \" : Mean:\" + mean)\r\n\t\t\t\tta_hours = 0\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tvar hours_alloted = Math.min(course_hours, ta_hours)\r\n\t\t// console.log(\"\\t HA: \" + hours_alloted)\r\n\t\tremaining_hours_men[course] -= hours_alloted\r\n\t\tremaining_hours_women[ta] -= hours_alloted\r\n\t\tif (hours_alloted != 0)\r\n\t\t\ttotal_matches.push([[course, ta], hours_alloted])\r\n\t})\r\n\t\r\n}\r\n\r\n//  Removes TAs and Courses if they are out of hours  //\r\nfunction remove_tas(){\r\n\tfree_men.forEach(course => {\r\n\t\tvar temp_array = [...preferred_rankings_men[course]]\r\n\t\tpreferred_rankings_men[course].forEach(ta => {\t\t\r\n\t\t\tif (remaining_hours_women[ta] === 0)\r\n\t\t\t\ttemp_array = removeItemOnce(temp_array, ta)\r\n\t\t})\r\n\t\tpreferred_rankings_men[course] = temp_array\r\n\t})\r\n\r\n\tpreferred_rankings_men[free_men[0]].forEach(ta => {\r\n\t\tvar temp_array = [...preferred_rankings_women[ta]]\r\n\t\tpreferred_rankings_women[ta].forEach(course => {\r\n\t\t\tif (!free_men.includes(course))\r\n\t\t\t\ttemp_array = removeItemOnce(temp_array, course)\r\n\t\t})\r\n\t\tpreferred_rankings_women[ta] = temp_array\r\n\t})\r\n}\r\n\r\n//  Adds dummie Tas or Courses to account for the restrictionn of the algorthim of tas and courses having to be the same length  //\r\nfunction add_dummies(){\r\n\tif (free_men.length < preferred_rankings_men[free_men[0]].length){\r\n\t\tconst difference = preferred_rankings_men[free_men[0]].length - free_men.length\r\n\t\tfor (let i of Array(difference).keys()) {\r\n\t\t\tconst dummy = 'dummy' + i\r\n\t\t\tpreferred_rankings_men[dummy] = [...preferred_rankings_men[free_men[i]]].reverse()\r\n\t\t\tremaining_hours_men[dummy] = 0\r\n\t\t\tfree_men.push(dummy)\r\n\t\t\t// for(let i = 0; i < preferred_rankings_men[free_men[0]].length; i++)\r\n\t\t\t// \tpreferred_rankings_women[preferred_rankings_men[free_men[0]][i]].push(dummy)\r\n\t\t\tpreferred_rankings_men[free_men[0]].forEach(ta => preferred_rankings_women[ta].push(dummy))\r\n\t\t}\r\n\t}else if ((free_men.length > preferred_rankings_men[free_men[0]].length) && (preferred_rankings_men[free_men[0]].length > 0)){\r\n\t\tconst difference = free_men.length - preferred_rankings_men[free_men[0]].length\r\n\t\tfor (let i of Array(difference).keys()) {\r\n\t\t\tconst dummy = 'dummy' + i\r\n\t\t\tpreferred_rankings_women[dummy] = [...preferred_rankings_women[preferred_rankings_men[free_men[0]][i]]].reverse()\r\n\t\t\tremaining_hours_women[dummy] = 0\r\n\t\t\t// for (let i=0; i < free_men.length; i++){\r\n\t\t\t// \tpreferred_rankings_men[free_men[0]].push(dummy)\r\n\t\t\t// }\r\n\t\t\tfree_men.forEach(course => preferred_rankings_men[course].push(dummy))\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//  Checks to see if all TAs or All Courses are out of hours  //\r\nfunction check_done(){\r\n\tvar ta_check = true\r\n\tvar course_check = true\r\n\tfor (const ta in preferred_rankings_women){\r\n\t\tif (remaining_hours_women[ta] > 0)\r\n\t\t\tta_check = false\r\n\t}\r\n\r\n\tfor (const course in preferred_rankings_men){\r\n\t\tif (remaining_hours_men[course] > 0)\r\n\t\t\tcourse_check = false\r\n\t}\r\n\r\n\treturn (ta_check || course_check)\r\n}\r\n\r\n//  Prints Schedule  //\r\nfunction make_schedule(){\r\n\tvar sched = {}\r\n\ttotal_matches.forEach(m => {\r\n\t\t// m is [[course, ta], hours_alloted]\r\n\t\tif (!(m[0][0] in sched))\r\n\t\t\tsched[m[0][0]] = []\r\n\t\tif (!m[0][0].includes('dummy') && !m[0][1].includes('dummy'))\r\n\t\t\tsched[m[0][0]].push([m[0][1], m[1]])\r\n\t})\r\n\tfor (var course in sched){\r\n\t\t// schedule[course].forEach(x => setTentSchedule(a += '[' + x + ']'))\r\n\t\t//   FILLS Dictionary for Table   // \r\n\t\twhile(sched[course].length < 2){\r\n\t\t\tsched[course].push(['', ''])\r\n\t\t}\r\n\t}\r\n\treturn sched;\r\n}\r\n\r\n//  Runs entire algorithm  //\r\nfunction run_all() {\r\n\tlet comp = 100\r\n\tlet compl = []\r\n\tlet count = 0\r\n\tlet current_matches = []\r\n\tlet remaining_hours = {}\r\n\tfor(var i = 0; i < ITERATIONS; i++){\r\n\t\t[preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women] = createCourseTas(courses, tas)\r\n\r\n\t\tfree_men = []\r\n\t\ttotal_matches = []\r\n\t\tinit_free_men()\r\n\t\ttentative_engagements = [...new Set([...predeterminations, ...current_matches])]\r\n\t\tallot_hours(tentative_engagements, true)\r\n\t\ttentative_engagements = []\r\n\t\tadd_dummies()\r\n\r\n\r\n\t\twhile ((!check_done()) && (free_men.length > 0)){\r\n\t\t\tstable_matching()\r\n\t\t\tallot_hours(tentative_engagements, false)\r\n\t\t\ttentative_engagements = []\r\n\t\t\tinit_free_men()\r\n\t\t\tif ((free_men.length > 0) && (preferred_rankings_men[free_men[0]].length > 0)){\r\n\t\t\t\tremove_tas()\r\n\t\t\t\tadd_dummies()\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Why is make_schedule called twice?\r\n\t\tconst [complications, working_matches] = validate_schedule(make_schedule(), courses)\r\n\t\tif (complications.length < comp){\r\n\t\t\tschedule = make_schedule()\r\n\t\t\tcompl = complications\r\n\t\t\tcomp = compl.length\r\n\t\t\tcurrent_matches = working_matches\r\n\t\t\tcount = 0\r\n\t\t\tremaining_hours = {...remaining_hours_men}\r\n\t\t} else if (count >= AUDIBLE_COUNT){\r\n\t\t\thistory.push([schedule, compl, comp, remaining_hours])\r\n\t\t\tcomp = 100\r\n\t\t\tcurrent_matches = []\r\n\t\t\tremaining_hours = {}\r\n\t\t\tcount = 0\r\n\t\t}\r\n\t\tconsole.log(compl.length);\r\n\t\tcount+=1;\r\n\t}\r\n\thistory.sort((a,b) => a[2] - b[2])\r\n\tschedule = history[0][0]\r\n\tconsole.log(history)\r\n\tconsole.log(schedule)\r\n\r\n}\r\n\r\nfunction validate_schedule(schedule, courses){\r\n\tvar complications = []\r\n\tvar working_matches = []\r\n\tfor (let course in schedule){\r\n\r\n\t\tconst l = schedule[course].length;\r\n\t\tif (l >= 3)\r\n\t\t\tcomplications.push([course, \"\", \"\", \"\", \"This course has \" + l + \" TAs\"])\r\n\t\tfor (var i = 0; i < l; i++){\r\n\t\t\tif (schedule[course][i][0] === '')\r\n\t\t\t\tcontinue;\r\n\t\t\tconst current_course = courses.find(c => c.CRN === course)\r\n\t\t\tlet course_ta = current_course.teacher_assistants.find(item => item.TAID === schedule[course][i][0]);\r\n\t\t\tif (course_ta.able == false) {\t\r\n\t\t\t\tlet curTA_uuid = schedule[course][i][0];\r\n\t\t\t\tlet curTA = tas.find(t => t.uuid === curTA_uuid);\r\n\t\t\t\tlet reasons = course_ta.reason;\r\n\t\t\t\t// Changed complications from having only one index to having multiple indices for easibility in retrieving information\r\n\t\t\t\tcomplications.push([course, curTA_uuid, curTA.firstName, curTA.lastName, reasons])\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tworking_matches.push([[course, schedule[course][i][0]],schedule[course][i][1]])\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn [complications, working_matches];\r\n}\r\n\r\n// Adding course name \r\nfunction course_name(course){\r\n\tconst current_course = courses.find(c => c.CRN === course);\r\n    const course_name = 'COMP ' + current_course.course_number;\r\n\treturn course_name;\r\n}\r\n\r\n// Combining the course's name , section , and crn\r\nfunction course_combo(course){\r\n\tconst current_course = courses.find(c => c.CRN === course);\r\n\tconst course_name = current_course.course_number;\r\n\treturn current_course.course_number + current_course.Section + course;\r\n}\r\n\r\n[preferred_rankings_men, preferred_rankings_women, remaining_hours_men, remaining_hours_women] = createCourseTas(courses, tas)\r\nrun_all()\r\n\r\nfunction convertToCSV(schedule, remaining_hours_men, conflictReport,) {\r\n    const rows = [];\r\n\tlet headers = \"Course,Remaining Hours,TA 1,TA 1 Hours,TA 2,TA 2 Hours,TA 3, TA 3 Hours,,Eligible TAs\";\r\n\r\n\t\r\n\tconsole.log(schedule);\r\n\tconsole.log(courses[0].teacher_assistants)\r\n    Object.keys(schedule).forEach((course) => {\r\n\t\tif ( schedule[course].length >= 3 ){\r\n\t\t\trows.push([        \r\n\t\t\t\tcourse,        \r\n\t\t\t\tremaining_hours_men[course],\r\n\t\t\t\tschedule[course][0][0],\r\n\t\t\t\tschedule[course][0][1],\r\n\t\t\t\tschedule[course][1][0],\r\n\t\t\t\tschedule[course][1][1],\r\n\t\t\t\tschedule[course][2][0],\r\n\t\t\t\tschedule[course][2][1],\t\r\n\t\t\t\t'|',\t\t\t\r\n\t\t\t].concat(courses.find(c => c.CRN === course).teacher_assistants.map(t => t.able_map).sort())\r\n\t\t\t);\r\n\t\t}else{\r\n\t\t\trows.push([        \r\n\t\t\t\tcourse_combo(course),        \r\n\t\t\t\tremaining_hours_men[course],\r\n\t\t\t\tschedule[course][0][0],\r\n\t\t\t\tschedule[course][0][1],\r\n\t\t\t\tschedule[course][1][0],\r\n\t\t\t\tschedule[course][1][1],\r\n\t\t\t\t'',\r\n\t\t\t\t'',\r\n\t\t\t\t'|',\r\n\t\t\t].concat(courses.find(c => c.CRN === course).teacher_assistants.map(t => t.able_map).sort())\r\n\t\t\t);\r\n\t\t}\r\n    });\r\n\r\n\trows.push([]);\r\n\trows.push([\"Conflict's Course Name\", \"Conflict's CRN\", \"UID\", \"Last Name\", \"First Name\", \"Conflict Reason\"]);\r\n\tconflictReport.forEach((conflict) =>{\r\n\t\trows.push([course_name(conflict[0]), conflict[0], conflict[1], conflict[2], conflict[3], conflict[4]]);\r\n\t});\r\n\t\r\n\r\n\t//const csv = headers + '\\n' + Object.entries(obj).map(([key, value]) => Object.values(value).join(',')).join('\\n');\r\n\tconst csv = headers + '\\n' + rows.map((row) => row.join(',')).join('\\n');\r\n\treturn csv;\r\n  }\r\n\r\nfunction downloadCSV(csvData, fileName) {\r\n\tconst blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });\r\n\tsaveAs(blob, fileName);\r\n  }\r\n  \r\nfunction handleDownload(event) {\r\n\tconst csv = convertToCSV(history[event.target.value][0], history[event.target.value][3], history[event.target.value][1]);\r\n\tdownloadCSV(csv, 'schedule' + event.target.value + '.csv');\r\n}\r\n\r\nconsole.log(history);\r\n\r\nreturn (\r\n\t<div>\r\n\t\t{/* Specifies the destination corressponding to each layout, so that the user can access the layout */}\r\n\t\t<Router>\r\n\t\t\t{/* Presented on the side within a sidebar for easy access, and to keep the necessary tools */}\r\n\t\t\t<div class=\"w3-sidebar w3-bar-block w3-border\" style={{width: \"10%\", height: \"auto\", position: \"relative\", float: \"left\", left: 10}}>\r\n\t\t\t\t\t{/* Links the user can click to the layout */}\r\n\t\t\t\t\t<Link to=\"/\" class=\"w3-bar-item w3-button w3-border-bottom\">Column View</Link>\r\n\t\t\t\t\t<Link to=\"/side_view\" class=\"w3-bar-item w3-button w3-border-bottom\">Side View</Link>\r\n\t\t\t\t\t<Link to=\"/schedules\" class=\"w3-bar-item w3-button w3-border-bottom\">Schedules</Link>\r\n\t\t\t\t\t<Link to=\"/conflicts\" class=\"w3-bar-item w3-button w3-border-bottom \">Conflicts</Link>\r\n\r\n\t\t\t\t\t<br></br>\r\n\r\n\t\t\t\t\t<button value={0} class=\"w3-bar-item w3-button w3-border-bottom\" style={{alignContent:\"left\"}} onClick={handleDownload}>Download Report 1</button>\r\n\t\t\t\t\t<button value={1} class=\"w3-bar-item w3-button w3-border-bottom\" style={{alignContent:\"left\"}} onClick={handleDownload}>Download Report 2</button>\r\n\t\t\t\t\t<button value={2} class=\"w3-bar-item w3-button w3-border-bottom\" style={{alignContent:\"left\"}} onClick={handleDownload}>Download Report 3</button>\t\t\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"container\" style={{left: 0}}>\r\n\t\t\t\t{/* Reference layoutHandlers folder that contains each of the layouts and their functions. */}\r\n\t\t\t\t<Routes>\r\n\t\t\t\t\t{console.log(tas)}\r\n\t\t\t\t\t<Route path=\"/\" element={ <ColbyCol taList={tas} coursesList={courses} reportOne={history[0]} reportTwo={history[1]} reportThree={history[2]}/> }></Route>\r\n\t\t\t\t\t<Route path=\"/side_view\" element={ <SidebySide taList={tas} coursesList={courses} reportOne={history[0]} reportTwo={history[1]} reportThree={history[2]}/> }></Route>\r\n\t\t\t\t\t<Route path=\"/schedules\" element={ <OnlySchedLayout taList={tas} coursesList={courses} scheduleOne={history[0][0]} scheduleTwo={history[1][0]} scheduleThree={history[2][0]} /> }></Route>\r\n\t\t\t\t\t<Route path=\"/conflicts\" element={ <OnlyConflictsLayout taList={tas} coursesList={courses} conflictsOne={history[0][1]} conflictsTwo={history[1][1]} conflictsThree={history[2][1]} /> }></Route>\r\n\t\t\t\t</Routes>\r\n\t\t\t</div>\r\n\t\t</Router>\r\n\t</div>\r\n);\r\n}\r\n\r\nexport default StableMarriage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}